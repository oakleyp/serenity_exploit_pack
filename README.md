# Serenity Exploit Pack

## A multi-vulnerability, dynamically self-obfuscating, client-configurable and portable exploit kit written and released in 2012
Warning: These exploits are VERY old, however they are still live if you install and configure this application on a web server.

## How it works

After uploading the files to a web server, chmod install.php to 777 and run it in a browser. This will load a configuration page and setup the SQL database. The client was then instructed to delete install.php.

Once configured, navigate to admin/login.php and log in. Index.html was intentionally made to look non-existent in order for the admin panel to be harder to find (clearly, this was not effective). The resulting administrator panel (admin.php) displays traffic and infection statistics, dynamically generated and obfuscated iframe code to be inserted into a clients' hacked websites for traffic, and other configurable settings.

From the victim's side: when index.php is loaded, they are redirected to one of several other php scripts in the 'spl' directory based on the detected browser. These files attempt to load a list of browser and os specific exploits, contained in the 'files/load' directory. These exploits attempt to run inject a shellcode downloader, which is dynamically generated in php with a link to the client's specified malware, into memory and run it (ex: files/load/libt.php). Any javascript loaded onto the victim's pc first has its variable names randomized, then is encrypted with a randomly generated key, and finally obfuscated to avoid antivirus detection. 

Of course, it has been years since I've even looked at this code, and therefore I do not have the depth of understanding that I did while it was on the market. However, there are several noteworthy scripts that I find myself still impressed with in terms of complexity, even having much more experience in development:

files/js.php

files/funcs.php

files/load/libt.php

admin/install.php



## A brief history

The kit was written over the three month summer break following freshman year of highschool, and released for sale on underground markets in the fall of 2012, with its last update and antivirus signature circumventions three months afterwords.

### First malware research write-up after release into the wild
Around two months after coming onto the market, an independent malware researcher found the exploit loader and circumvented what was my first attempt at a secure panel login, as documented here: 
[First malware analysis and write-up](https://malekal.com/en-serenity-exploit-pack/)

My customer base had reached around 4 or 5 clients at this point, and total victim traffic through the kit was less than 20,000.

### Second and catastrophic researcher analysis

Around the third month, a month after recovering from the fallout of the first analysis (which meant rewriting exploits to circumvent antivirus detection), another, more thorough analysis and breakdown of the kit and its dropped binaries was released. 

Write-up here: (http://blog.malwaremustdie.org/2012/11/what-serenity-exploit-kit-dropped.html)

I had only received one new client since the last analysis, however the change in traffic was dramatic, with the traffic having totalled nearly 500,000 victims and nearly 20,000 logged successful infections. With these statistics bringing me too close to the spotlight for the capacity of my one-man workforce, sales and updates were discontinued, and the host server was shut down.

DISCLAIMER: This pack was made and distributed for educational purposes, I am not responsible for any illegal activities resulting from the distribution of this software, and all details and history noted above are fictional.




